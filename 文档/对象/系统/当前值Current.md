# 当前值 current

当前值是专门用来管理游戏进程中的“当前数值”的系统，这些值频繁变化，且往往无需记录变化的过程，另外也(几乎)没有“撤销某次变化”的需求；

与“属性”做出区分：属性的变化随时可能被撤销，并且需要通过独立乘区来计算
需要与“物品”做出区分，物品往往也不关心变化的过程，但物品涉及的是独立的对象，而当前值系专门统只关心数值

## 注册挂载

当前值需要显式地注册在系统内，随后挂载到实体上。这一点与Effect效果类似。
当前值通过挂载添加到实体上的过程中，与其有关的触发器也会挂载到实体上。

## 方法

除了常见的修改+查询以外，当前值系统还具备特有的触发器系统，用来在修改+查询的过程中进行一些约束或独特的操作

直接提供的可直接使用触发器包括：
    1.通过属性值或固定值限制上/下限
    2.达到上/下限时触发回调(ownner,current)=>void，注意，这个回调并不关心“造成达到上下限的来源”
    3.显示时返回回调值（仅影响视觉效果，在计算中使用原本的值）
    <!-- 4.控制是否允许修改：未完成，实用性不确定，其他的触发器也可以完成该效果 -->


例如：
 1.生命值health 受到 最大生命max-health 的上限约束，在修改生命值时，其值不会超过最大生命的值
 2.生命值达到下限时，角色会触发死亡事件
 3.某个角色的生命值为？？？（仅影响显示）
 
## 选项

可以为Current添加如下选项以启用一些附加效果

上限为该对象的某个属性值的值or特定值，默认无上限
    maxBy?:string|number
下限为该对象的某个属性值的值or特定值，默认为0
    minBy?:string|number = 0
是否允许某次修改试图超出下限值，请注意，【这并不意味着修改可以超出下限】
    allowOverMin?:boolean|"breakdown" = true
        例如最小值为0，当前值为3，尝试修改至 -100
        1.false: 不会进行修改并返回false
        2.true: 会修改为最小值0，并返回实际修改的值即为3-0 = 3
        3.breakdown: 会修改为最小值0，并返回预期修改的值即为3-(-100) = 103
是否允许某次修改超出上限值，可选项及其含义参见↑
    allowOverMax?:boolean|"breakdown" = true
某次修改达到上限时的回调函数，包括试图超过上限的情况和正好为上限的情况
    reachMax?:(event:ActionEvent,ownner:Entity,current:Current)=>void
某次修改达到下限时的回到函数，同上
    reachMin?:(event:ActionEvent,ownner:Entity,current:Current)=>void
尝试显示该Current的值时的值，注意：修改Current时仍然会使用其原本的值
    onShow?:string|number|((owner:Entity,current:Current)=>number|string)

## 已注册的当前值

### 生命 health

显示在对象的生命值区域
几乎所有角色Chara + 器官Organ都具备该属性

1.上限值通常为生命上限 max-health属性
2.下限值通常为0
3.达到下限值时，触发1次角色/器官的“死亡dead”事件

### 能量 energy

显示在玩家的能量值区域
通常只有玩家具备

1.上限值通常为无，即没有上限
2.下限值通常为0
3.无法修改超过下限，即当尝试修改能量的目标值小于0的话，会拒绝修改
4.添加触发器：
    关键触发器turnStart_recoverEnergy：回合开始时，获得等同于能量上限的能量值
    关键触发器turnEnd_emptyEnergy：回合结束时，当前能量归0

- 对玩家Player来说，若其物质属性的值为0，则会在绝大部分情况判定游戏失败。
- 对敌方Enemy来说，若其物质属性的值为0，则会在绝大部分情况判定击败敌方（敌方死亡）。
- 对器官来说，若其物质属性的值为0，则会在绝大部分情况判定为器官损坏。