# Born The Spire - 产品文档

## 为什么存在

Born The Spire 的诞生源于对经典卡牌 RPG 游戏 Slay the Spire 的热爱，以及对现代 Web 技术的探索。项目旨在创建一个可玩性强、易于扩展、架构清晰的桌面卡牌游戏，展示事件驱动架构在游戏开发中的应用。

## 解决的问题

### 技术层面

1. **游戏状态管理复杂性**
   - 问题：传统游戏开发中，状态管理和事件处理容易耦合，导致代码难以维护
   - 解决方案：通过事务系统和事件驱动架构，实现清晰的状态流转和事件触发机制

2. **扩展性挑战**
   - 问题：添加新卡牌、新效果、新触发器时往往需要修改多处代码
   - 解决方案：采用注册表模式（effectMap、statusMap等），通过 JSON 配置即可扩展游戏内容

3. **响应式 UI 难题**
   - 问题：游戏状态变化需要实时反映到 UI 上
   - 解决方案：基于 Vue 3 的响应式系统，结合 refValue hook 实现自动更新

### 游戏设计层面

1. **玩法深度**
   - 问题：简单的卡牌游戏容易缺乏策略深度
   - 解决方案：引入器官系统、触发器系统、状态系统，提供丰富的组合可能性

2. **平衡性调整**
   - 问题：卡牌效果的数值平衡难以调整
   - 解决方案：通过独立乘区和修饰器系统，实现灵活的数值计算

## 如何工作

### 核心机制

Born The Spire 的游戏循环遵循以下流程：

1. **操作触发**
   - 玩家执行操作（打出卡牌、使用药水等）
   - 操作创建初始的 ActionEvent

2. **事务收集**
   - ActionEvent 触发相关触发器
   - 触发器产生新的事件
   - 所有相关事件被收集到同一个事务中

3. **事件执行**
   - 事务整理事件顺序
   - 按照阶段（phase）依次执行事件效果
   - 效果通过 EffectFunc 对实体产生影响

4. **状态更新**
   - 效果修改实体的状态（Status）和当前值（Current）
   - UI 通过响应式系统自动更新

### 关键概念

- **实体（Entity）**: 游戏中的所有对象，包括卡牌、角色、敌人、器官等
- **事件（ActionEvent）**: 游戏中发生的各种情况，携带效果和阶段
- **效果（Effect）**: 对实体产生影响的具体操作
- **触发器（Trigger）**: 监听特定事件并响应的机制
- **事务（Transaction）**: 管理一系列相关事件的执行顺序

## 用户体验目标

### 玩家体验

1. **流畅的游戏节奏**
   - 快速的卡牌使用反馈
   - 清晰的效果展示
   - 直观的战斗流程

2. **深度策略**
   - 丰富的卡牌组合
   - 有意义的决策选择
   - 长期成长感（通过器官、遗物等系统）

3. **易学难精**
   - 简单的基础规则
   - 复杂的高级机制
   - 逐步解锁的深度

### 开发者体验

1. **清晰的架构**
   - 模块化的代码结构
   - 明确的职责划分
   - 易于理解的代码流

2. **易于扩展**
   - 通过配置文件添加新内容
   - 插件化的效果系统
   - 灵活的触发器机制

3. **良好的文档**
   - 完整的架构说明
   - 详细的 API 文档
   - 实用的示例代码

## 目标平台

- **桌面应用**: 通过 Tauri 打包为原生应用
- **Web 应用**: 支持浏览器直接运行
- **跨平台**: Windows、macOS、Linux

## 未来方向

1. **内容扩展**
   - 更多卡牌、敌人、房间类型
   - 新的器官和遗物
   - 不同的角色和起始卡组

2. **功能完善**
   - 存档系统
   - 成就系统
   - 模组支持

3. **体验优化**
   - 更丰富的动画效果
   - 音效和音乐
   - 更好的教程和引导