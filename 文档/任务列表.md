[toc]

为什么收集到的事件的执行顺序不对？
=>重构触发器和对象构建过程，触发器事件和效果事件分开来

按照eventloop来做吧！

造成伤害→target:受到伤害时，减少1伤害=>state:减少伤害时，该效果无效

actionEvent:damage
=>before
actionEvent:reduceDamage
=>before
state:无效

事件damage=>触发器=>事件reduceDamage=>触发器=>state无效上一个


词条也可以用trigger来做

可以给效果等对象的value一个[1,9]这样的值，然后在init这个对象时，通过统一函数来roll取随机值？这样就不用写一长串了？毕竟effect就是随用随销的？

回合行为也要用trigger实现：how？player:在player中添加trigger！比如抽牌和弃牌！
属性也要用trigger实现

阶段开始时回复/不回复生命=>应当与难度有关，某个难度下为玩家添加触发器：阶段开始时回复生命

我希望可以获取触发器调用的链条，另外我还希望获得添加触发器的来源

=>如何管理这些触发器？？？？

是否应该让一切都由触发器调用？
=>原作里是一切都是state(状态)，但state的本质都是触发器
=>status也应该包含触发器
=>触发器行为应该定制
=>一部分效果effect应当脱离触发器，独立出来 
    =>例如“造成伤害”这个效果，应该是这样的流程：创建卡牌>卡牌的效果中包含“打出时对目标造成伤害”的修饰符>创建“打出时”触发器>该触发器调用“对目标造成伤害”的效果>获得卡牌对象，其包含一个触发器，触发时调用效果函数

    =>打出这张卡牌 > 触发“打出时”触发器 > 产生”造车




核心问题是：导致状态层数减少的对象就是它自己！

2.统一behavior行为和触发器的构建过程：state和entity



日志，调试工具

状态卡，buff对象

卡牌目标的筛选

选择卡牌

1. 从手牌选择
2. 从某些卡牌中选择
    1. 一个取消显示的按钮，可以用来显示背层的内容

在卡牌or对象旁边显示的提示文本，一个框框

卡牌的参数与读取参数的通用函数

遗物和药水



效果是一个带有效果对象的，可以在执行过程中进行编辑的事件过程

行为是一个带有信息的，不会在执行过程中进行编辑的事件过程，行为通常是一个效果的宣言

# 对象创建

# 打牌过程

1. 打出牌，选择目标
    1. 能否打出这张牌
    2. 目标类型，判断目标是否满足条件
    3. 特殊条件的判断

# 战斗流程

1. 玩家回合
    1. 自动顺序
        1. 回合开始
            1. 恢复能量
            2. 抽卡
        2. 自由行动
        3. 结束回合
            1. 丢弃手牌
    2. 各类行动
        1. 打牌
        2. 使用药水
        3. 使用遗物
        4. 使用器官
        5. 手动结束回合
2. 敌人回合
    1. 敌人意图
    2. 敌人如何行动
3. 战斗结束获取奖励

# 爬塔流程

1. 事件组件，抽取房间
2. 各类房间
    1. 水池
    2. 黑市
    3. 其他

# 游戏服务

1. 卡组显示
2. 各类信息显示
3. 待定

# 杂项



